export async function handler(event, context) {
  const formName = "rsvp"; // sama macam nama <form name="rsvp">
  const token = process.env.NETLIFY_ACCESS_TOKEN;

  const formRes = await fetch("https://api.netlify.com/api/v1/forms", {
    headers: { Authorization: `Bearer ${token}` },
  });
  const forms = await formRes.json();
  const form = forms.find((f) => f.name === formName);
  if (!form) return { statusCode: 404, body: "Form not found" };

  const submissionsRes = await fetch(`https://api.netlify.com/api/v1/forms/${form.id}/submissions`, {
    headers: { Authorization: `Bearer ${token}` },
  });
  const submissions = await submissionsRes.json();

  return {
    statusCode: 200,
    body: JSON.stringify(submissions),
  };
}
